<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trabalhos de Designer</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: #e5e7eb;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
}

.chat-container {
  width: 100%;
  max-width: 420px;
  background: #020617;
  border-radius: 16px;
  padding: 16px;
  box-shadow: 0 0 40px rgba(0,0,0,0.6);
}

.chat {
  display: flex;
  flex-direction: column;
  gap: 12px;
  max-height: 65vh;
  overflow-y: auto;
}

.msg {
  max-width: 85%;
  padding: 10px 14px;
  border-radius: 14px;
  font-size: 14px;
}

.bot { background: #1e293b; align-self: flex-start; }
.user { background: #2563eb; align-self: flex-end; }

.input-area {
  margin-top: 12px;
  display: flex;
  gap: 8px;
}

input[type="text"], input[type="email"] {
  flex: 1;
  padding: 10px;
  border-radius: 10px;
  border: none;
}

button {
  background: #2563eb;
  border: none;
  color: white;
  padding: 10px 14px;
  border-radius: 10px;
  cursor: pointer;
  font-size: 16px;
}

.hidden { display: none; }

/* Pagamento */
.payment {
  background: #151515;
  border-radius: 12px;
  padding: 20px;
  color: #fff;
}

.card {
  background: #1c1c1c;
  border-radius: 10px;
  padding: 16px;
  margin-bottom: 16px;
}

.upload {
  border: 2px dashed #333;
  border-radius: 10px;
  padding: 16px;
  text-align: center;
  cursor: pointer;
}

.upload input { display: none; }

.confirm {
  width: 100%;
  padding: 14px;
  background: #2ecc71;
  border: none;
  border-radius: 10px;
  font-size: 16px;
  cursor: pointer;
}
</style>
</head>

<body>

<form class="chat-container"
      action="https://api.web3forms.com/submit"
      method="POST"
      enctype="multipart/form-data">

  <!-- Web3Forms -->
  <input type="hidden" name="access_key" value="SUA_ACCESS_KEY_WEB3FORMS">

  <!-- Dados -->
  <input type="hidden" name="tipo" id="tipo">
  <input type="hidden" name="nome_marca" id="nomeMarca">
  <input type="hidden" name="descricao_texto" id="descricaoTexto">
  <input type="hidden" name="descricao_audio" id="descricaoAudio">

  <!-- CHAT -->
  <div id="chatArea">
    <div id="chat" class="chat"></div>

    <div id="stepNome" class="input-area hidden">
      <input type="text" id="inputNome" placeholder="Digite ou grave o nome da marca">
      <button type="button" id="btnNome">üéôÔ∏è</button>
    </div>

    <div id="stepRefs" class="upload hidden">
      <label>
        üìé Enviar refer√™ncias
        <input type="file" name="referencias[]" multiple>
      </label>
      <button type="button" id="btnPagamento">Continuar</button>
    </div>
  </div>

  <!-- PAGAMENTO -->
  <div id="paymentArea" class="payment hidden">

    <div class="card">
      <strong>Servi√ßo</strong><br>
      <span id="servicoText"></span><br>
      Prazo: at√© 3 dias<br>
      Revis√µes: 1<br>
      Valor: <strong>R$ XXX,00</strong>
    </div>

    <label>E-mail para entrega</label>
    <input type="email" name="email" required>

    <div class="card">
      <strong>Pagamento Pix</strong><br>
      trabalhosdedesigner@email.com
    </div>

    <div class="card">
      <strong>Comprovante</strong>
      <label class="upload">
        üìé Anexar comprovante
        <input type="file" name="comprovante" required>
      </label>
    </div>

    <button class="confirm" type="submit">Confirmar pagamento</button>
  </div>

</form>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const chat = document.getElementById("chat");
  const stepNome = document.getElementById("stepNome");
  const stepRefs = document.getElementById("stepRefs");

  const inputNome = document.getElementById("inputNome");
  const btnNome = document.getElementById("btnNome");

  function addMsg(text, type="bot", delay=0) {
    setTimeout(() => {
      const d = document.createElement("div");
      d.className = `msg ${type}`;
      d.innerText = text;
      chat.appendChild(d);
      chat.scrollTop = chat.scrollHeight;
    }, delay);
  }

  /* Servi√ßo */
  const tipoServico = localStorage.getItem("servico") || "logo";
  const nomeServico = tipoServico === "logo" ? "Logotipo" : "Logo Animado";

  document.getElementById("tipo").value = tipoServico;
  document.getElementById("servicoText").innerText = nomeServico;

  /* Conversa inicial (animada) */
  addMsg(`Servi√ßo selecionado: ${nomeServico}`);
  addMsg("Ol√°! Vou te ajudar com seu projeto üôÇ", "bot", 800);
  addMsg("Para come√ßar, qual √© o nome da marca?", "bot", 1600);

  setTimeout(() => {
    stepNome.classList.remove("hidden");
  }, 1800);

  /* Troca autom√°tica üéôÔ∏è ‚Üî ‚û§ */
  inputNome.addEventListener("input", () => {
    btnNome.innerText = inputNome.value.trim() ? "‚û§" : "üéôÔ∏è";
  });

  let recognition;

  btnNome.onclick = () => {
    if (inputNome.value.trim()) {
      enviarTexto();
    } else {
      iniciarAudio();
    }
  };

  function enviarTexto() {
    const v = inputNome.value.trim();
    addMsg(v, "user");
    document.getElementById("nomeMarca").value = v;
    document.getElementById("descricaoTexto").value = v;
    avancar();
  }

  function iniciarAudio() {
    const SpeechRecognition =
      window.SpeechRecognition || window.webkitSpeechRecognition;

    if (!SpeechRecognition) {
      alert("Seu navegador n√£o suporta √°udio.");
      return;
    }

    recognition = new SpeechRecognition();
    recognition.lang = "pt-BR";
    recognition.interimResults = false;

    btnNome.innerText = "‚èπÔ∏è";

    recognition.onresult = e => {
      const texto = e.results[0][0].transcript;
      addMsg("üéôÔ∏è " + texto, "user");
      document.getElementById("nomeMarca").value = texto;
      document.getElementById("descricaoAudio").value = texto;
      avancar();
    };

    recognition.onend = () => {
      btnNome.innerText = "üéôÔ∏è";
    };

    recognition.start();
  }

  function avancar() {
    stepNome.classList.add("hidden");
    addMsg("Agora envie refer√™ncias visuais.");
    stepRefs.classList.remove("hidden");
  }

  document.getElementById("btnPagamento").onclick = () => {
    document.getElementById("chatArea").classList.add("hidden");
    document.getElementById("paymentArea").classList.remove("hidden");
  };

});
</script>

</body>
</html>
